<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>AI SMART UPLOAD SYSTEM | PRO CATEGORY VERSION</title>
<style>
body{background:#0a0a0a;color:#eee;font-family:'Segoe UI',Arial,sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
.box{background:#111;padding:35px;border-radius:15px;border:2px solid #f39c12;width:560px;box-shadow:0 10px 30px rgba(0,0,0,.5)}
h2{color:#f39c12;text-align:center;margin-top:0;letter-spacing:2px;text-transform:uppercase;font-size:20px}
input,textarea{width:100%;padding:12px;margin:10px 0;border-radius:6px;border:1px solid #333;background:#1a1a1a;color:#fff;box-sizing:border-box;outline:none}
button{width:100%;padding:15px;background:#27ae60;color:#fff;border:none;border-radius:6px;font-weight:bold;cursor:pointer;font-size:16px;transition:.3s;margin-top:10px}
button:hover{background:#2ecc71}
#log{margin-top:15px;font-size:11px;color:#aaa;text-align:left;max-height:200px;overflow-y:auto;padding:12px;background:#000;border-radius:5px;border:1px solid #222}
</style>
</head>
<body>

<div class="box">
<h2>SISTEM OTOMATIK YUKLEME v3.0</h2>
<input type="password" id="tk" placeholder="GitHub Personal Access Token">
<input type="file" id="fi" multiple accept=".jpg,.eps">
<textarea id="desc" rows="3" placeholder="Aciklama bos kalirsa otomatik premium aciklama eklenir"></textarea>
<button id="btn" onclick="startProcess()">DOSYALARI ISLE VE YUKLE</button>
<div id="log">Sistem hazir. Akilli kategori motoru aktif.</div>
</div>

<script>

/* =========================
   CATEGORY KEYWORD DATABASE
========================= */

const catKeywords = {
abstract:"abstract,background,pattern,texture,modern,artistic,colorful,geometric,wave,line,futuristic,minimal,creative,composition,element,digital,gradient,flow,concept,visual,shape",
animals:"animal,pet,wild,nature,mammal,bird,cat,dog,lion,tiger,wildlife,fauna,creature,cute,adorable,safari,jungle,forest,habitat",
business:"business,corporate,office,finance,marketing,strategy,management,career,company,meeting,growth,success,team,analytics,economy",
education:"education,school,learning,student,teacher,university,study,knowledge,classroom,library,college,science,graduation",
food:"food,meal,dish,healthy,organic,delicious,tasty,nutrition,cooking,restaurant,gourmet,menu,breakfast,lunch,dinner",
nature:"nature,landscape,outdoor,environment,sky,mountain,forest,tree,water,river,lake,flower,garden,eco,earth",
people:"people,person,human,character,portrait,family,community,social,lifestyle,group,happy,activity",
technology:"technology,digital,innovation,computer,software,internet,network,ai,virtual,data,cloud,cyber,robot,modern",
sports:"sport,fitness,training,athlete,gym,exercise,competition,football,basketball,tennis,running,workout",
vintage:"vintage,retro,classic,old,antique,nostalgic,ornament,decorative,heritage,history"
};

const genericPool = [
"vector","illustration","graphic","design","isolated","eps",
"flat-design","clip-art","digital-art","stock","premium",
"commercial","high-quality","professional","template",
"modern","creative","background","icon","symbol","element",
"web","print","collection","resource","visual","unique",
"download","artwork","file","editable"
];

/* =========================
   START PROCESS
========================= */

async function startProcess(){

const token=document.getElementById('tk').value.trim();
const files=Array.from(document.getElementById('fi').files);
const globalDesc=document.getElementById('desc').value.trim();
const log=document.getElementById('log');

if(!token||files.length===0){
alert("Token ve dosyalar gerekli!");
return;
}

document.getElementById('btn').disabled=true;
log.innerHTML="<b>Islem basladi...</b>";

const jpegs=files.filter(f=>f.name.toLowerCase().endsWith('.jpg'));

for(let jpg of jpegs){

let base=jpg.name.replace(/\.[^/.]+$/,"");
let clean=base.toLowerCase()
.replace(/\s+/g,'-')
.replace(/[()]/g,'')
.replace(/[^a-z0-9-]/g,'')
.replace(/-+/g,'-');

let folder=`${clean}-${Math.floor(10000+Math.random()*90000)}`;

const eps=files.find(f=>f.name.replace(/\.[^/.]+$/,"")===base && f.name.toLowerCase().endsWith('.eps'));
if(!eps) continue;

log.innerHTML+=`<div>Yukleniyor: ${folder}</div>`;

try{

await push(folder,jpg,`${folder}.jpg`,token);
await push(folder,eps,`${folder}.eps`,token);

/* CATEGORY DETECTION */

let selectedCategory=null;

for(let cat in catKeywords){
if(clean.includes(cat)){
selectedCategory=cat;
break;
}
}

/* KEYWORD GENERATION (45 UNIQUE) */

let finalKeywords=new Set();

if(selectedCategory){
catKeywords[selectedCategory].split(",").forEach(k=>finalKeywords.add(k.trim()));
}

genericPool.forEach(k=>finalKeywords.add(k));

let keywordArray=Array.from(finalKeywords);
keywordArray=keywordArray.slice(0,45);

const data={
name:folder,
desc:globalDesc || `Premium ${clean.replace(/-/g,' ')} vector illustration for professional design projects.`,
keys:keywordArray.join(", ")
};

await update(data,token);

log.innerHTML+=`<div style="color:#27ae60">BASARILI: ${folder}</div>`;

}catch(e){
log.innerHTML+=`<div style="color:red">HATA: ${e.message}</div>`;
}

}

log.innerHTML+="<div><b>TUM ISLEMLER TAMAMLANDI</b></div>";
document.getElementById('btn').disabled=false;
}

/* =========================
   GITHUB UPLOAD
========================= */

async function push(folder,file,name,token){

const b64=await toBase64(file);

const url=`https://api.github.com/repos/free-vector-stock/free-vector-stock/contents/vectors/${folder}/${name}`;

const res=await fetch(url,{
method:'PUT',
headers:{
'Authorization':`token ${token}`,
'Content-Type':'application/json'
},
body:JSON.stringify({
message:`Add ${name}`,
content:b64.split(',')[1]
})
});

if(!res.ok){
const err=await res.json();
throw new Error(err.message);
}
}

/* =========================
   UPDATE JSON
========================= */

async function update(newData,token){

const url=`https://api.github.com/repos/free-vector-stock/free-vector-stock/contents/vectors.json`;

const res=await fetch(url,{headers:{'Authorization':`token ${token}`}});

if(!res.ok) throw new Error("vectors.json okunamadi");

const file=await res.json();

const decoded=decodeURIComponent(escape(atob(file.content.replace(/\n/g,''))));

let list=[];
try{ list=JSON.parse(decoded); } catch { list=[]; }

list.unshift(newData);

const updated=await fetch(url,{
method:'PUT',
headers:{
'Authorization':`token ${token}`,
'Content-Type':'application/json'
},
body:JSON.stringify({
message:"Update vectors.json",
content:btoa(unescape(encodeURIComponent(JSON.stringify(list,null,2)))),
sha:file.sha
})
});

if(!updated.ok){
const err=await updated.json();
throw new Error(err.message);
}
}

/* =========================
   BASE64
========================= */

function toBase64(file){
return new Promise((resolve,reject)=>{
const reader=new FileReader();
reader.readAsDataURL(file);
reader.onload=()=>resolve(reader.result);
reader.onerror=error=>reject(error);
});
}

</script>

</body>
</html>
